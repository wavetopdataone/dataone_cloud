(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{RJM5:function(e,a,t){"use strict";t.r(a),function(e){t("Pwec");var s=t("CtXQ"),n=(t("IzEo"),t("bx4M")),l=(t("miYZ"),t("tsqr")),r=(t("fOrg"),t("+KLJ")),o=(t("5NDa"),t("5rEg")),i=t("2Taf"),m=t.n(i),c=t("vZ4D"),p=t.n(c),d=t("l4Ni"),u=t.n(d),h=t("ujKo"),f=t.n(h),w=t("MhPg"),E=t.n(w),b=(t("y8nQ"),t("Vl3Y")),C=(t("B9cy"),t("Ol7k")),v=(t("2qtc"),t("kLXV")),g=t("q1tI"),y=t.n(g),S=t("vDqi"),k=t.n(S),I=t("jHKv"),_=(t("kQFk"),t("gtCd")),P=t.n(_),N=v.a.confirm,V=C.a.Content,x=(C.a.Sider,b.a.create()(function(e){function a(e){var t;return m()(this,a),(t=u()(this,f()(a).call(this,e))).state={email:e.formValues.email,userId:e.formValues.user_id},t}return E()(a,e),p()(a,[{key:"render",value:function(){var e=this.props,a=e.visible,t=e.onCancel,s=e.onCreate,n=e.form.getFieldDecorator;return y.a.createElement(v.a,{visible:a,title:"修改邮箱",okText:"确认",onCancel:t,onOk:s},y.a.createElement(b.a,null,y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"邮箱"},n("email",{rules:[{required:!0,message:"Please input your username!"}],initialValue:this.state.email})(y.a.createElement("span",null,this.state.email))),y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"密码验证"},n("password",{rules:[{required:!0,message:"请输入dataone登录密码!"}]})(y.a.createElement(o.a,{type:"password",placeholder:"请输入dataone登录密码"}))),y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"新邮箱"},n("newEmail",{rules:[{required:!0,type:"email",message:"请输入正确格式的邮箱"}]})(y.a.createElement(o.a,{type:"email",placeholder:"请输入新邮箱地址"}))),y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"确认邮箱"},n("newEmail2",{rules:[{required:!0,type:"email",message:"请输入正确格式的邮箱"}]})(y.a.createElement(o.a,{type:"email",placeholder:"请再次确认新邮箱地址"})))))}}]),a}(y.a.Component))),q=b.a.create()(function(e){function a(e){var t;return m()(this,a),(t=u()(this,f()(a).call(this,e))).state={email:e.formValues.email,userId:e.formValues.user_id},t}return E()(a,e),p()(a,[{key:"render",value:function(){var e=this.props,a=e.visible,t=e.onCancel,s=e.onCreate,n=e.form.getFieldDecorator;return y.a.createElement(v.a,{visible:a,title:"修改邮箱",okText:"确认",onCancel:t,onOk:s,bodyStyle:{padding:0}},y.a.createElement(r.a,{message:"说明：绑定系统邮箱后会自动抓取系统内所有任务的数据任务错误信息、错误队列预警、错误队列暂停、数据源变化通知，上述消息会通过系统邮箱发送至各个任务的参与人邮箱",banner:!0,showIcon:!1,style:{color:"#408AFF",background:"#F5F9FD",padding:"15px",marginBottom:10,fontSize:12}}),y.a.createElement(b.a,null,y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"邮箱"},n("email",{rules:[{required:!0,message:"Please input your username!"}],initialValue:this.state.email})(y.a.createElement("span",null,this.state.email))),y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"密码验证"},n("password",{rules:[{required:!0,message:"请输入dataone登录密码!"}]})(y.a.createElement(o.a,{type:"password",placeholder:"请输入dataone登录密码"}))),y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"新邮箱"},n("newEmail",{rules:[{required:!0,type:"email",message:"请输入正确格式的邮箱"}]})(y.a.createElement(o.a,{type:"email",placeholder:"请输入新邮箱地址"}))),y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"邮箱密码"},n("emailPassword",{rules:[{required:!0,message:"请输入正确的邮箱密码"}]})(y.a.createElement(o.a,{type:"password",placeholder:"请输入正确的邮箱密码"})))))}}]),a}(y.a.Component)),T=b.a.create()(function(e){function a(){return m()(this,a),u()(this,f()(a).apply(this,arguments))}return E()(a,e),p()(a,[{key:"render",value:function(){var e=this.props,a=e.visible,t=e.onCancel,s=e.onCreate,n=e.form.getFieldDecorator;return y.a.createElement(v.a,{visible:a,title:"修改密码",okText:"确认",onCancel:t,onOk:s},y.a.createElement(b.a,null,y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"原密码"},n("password",{rules:[{required:!0,message:"请输入原密码!"}]})(y.a.createElement(o.a,{type:"password",placeholder:"请输入原密码"}))),y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"新密码"},n("newPassword",{rules:[{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/,message:"请输入正确格式的密码（长度不小于8位，不大于20位，包含至少一位大写字母，一位小写字母）!",min:8,max:20}]})(y.a.createElement(o.a,{type:"password",placeholder:"请输入新密码"}))),y.a.createElement(b.a.Item,{labelCol:{span:6},wrapperCol:{span:14},label:"确认密码"},n("newPassword2",{rules:[{required:!0,pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{8,16}$/,message:"请输入正确格式的密码（长度不小于8位，不大于20位，包含至少一位大写字母，一位小写字母）!",min:8,max:20}]})(y.a.createElement(o.a,{type:"password",placeholder:"请再次输入新密码"})))))}}]),a}(y.a.Component)),F=function(a){function t(){var a;return m()(this,t),(a=u()(this,f()(t).apply(this,arguments))).state={selectItem:"1",stepValue:"1",user_name:1==localStorage.getItem("role_id")?"admin":""},a.personal=function(){k()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_user/personal/",headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),a.setState({formValues:e.data.data,user_name:e.data.data.user_name,dept_name:e.data.data.dept_name,count_job:e.data.data.count_job,email:e.data.data.email,user_id:e.data.data.user_id,password:e.data.data.password})}).catch(function(e){})},a.onChange=function(){a.setState({stepValue:"2"})},a.showModal=function(e){1==e?a.setState({visible:!0}):2==e?a.setState({visiblePassword:!0}):3==e&&a.setState({visibleEmail:!0})},a.handleCancel=function(){a.setState({visible:!1,visiblePassword:!1,visibleEmail:!1})},a.handleCreate=function(){a.formRef.props.form.validateFields(function(e,t){e||(void 0==t.newEmail||void 0==t.newEmail2||t.newEmail==t.newEmail2?void 0==t.newPassword||t.newPassword==t.newPassword2?a.handleAdd(t):l.a.error("密码不一致，请再次确认密码！"):l.a.error("邮箱不一致，请再次确认新邮箱地址！"))})},a.handleAdd=function(t){var s=e.constants.httpType+e.constants.website+"/sys_user/updUserEmail/";t.userId=a.state.user_id,void 0!=t.newEmail2&&(delete t.newEmail2,delete t.email),void 0!=t.emailPassword&&(delete t.email,s=e.constants.httpType+e.constants.website+"/sys_user/updSuperEmail/"),void 0!=t.newPassword&&(delete t.newPassword2,s=e.constants.httpType+e.constants.website+"/sys_user/updPassword/"),k()({method:"post",url:s,data:I.a.Amap(t),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){if("401"==e.data.status&&(window.location.href="/user"),1==e.data.status){if(l.a.success("操作成功"),void 0!=t.newPassword)return void(window.location.href="/");a.personal()}else if(0==e.data.status)return void l.a.error(e.data.message);a.setState({visible:!1,visiblePassword:!1,visibleEmail:!1})}).catch(function(e){})},a.saveFormRef=function(e){a.formRef=e},a.addSubmit=function(t){delete t.password1;var s=2;3==a.state.role_id&&(s=3),k()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_user/addUser/?id="+s,data:t,headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),1==e.data.status?(l.a.success("操作成功"),a.setState({userid:e.data.id,stepValue:"2"})):l.a.error(e.data.message)}).catch(function(e){})},a.emailChange=function(e){N({title:y.a.createElement("span",null,"修改邮箱"),width:500,content:e,footer:null})},a}return E()(t,a),p()(t,[{key:"componentDidMount",value:function(){this.personal()}},{key:"render",value:function(){var e=this;return y.a.createElement(C.a,{className:P.a.layoutBox},y.a.createElement(V,{style:{background:"#fff",padding:24,minHeight:280}},y.a.createElement(n.a,{title:"个人设置"},y.a.createElement("div",{className:P.a.personalBox},y.a.createElement("p",null,y.a.createElement("span",{className:P.a.firstSpan},"用户名 :"),y.a.createElement("span",{className:P.a.secondSpan},this.state.user_name)),y.a.createElement("p",{style:{display:1==localStorage.getItem("role_id")?"none":"block"}},y.a.createElement("span",{className:P.a.firstSpan},"小组 :"),y.a.createElement("span",{className:P.a.secondSpan},this.state.dept_name)),y.a.createElement("p",{style:{display:1==localStorage.getItem("role_id")?"none":"block"}},y.a.createElement("span",{className:P.a.firstSpan},"已参与任务数 :"),y.a.createElement("span",{className:P.a.secondSpan},this.state.count_job)),y.a.createElement("p",{style:{display:1==localStorage.getItem("role_id")?"block":"none"}},y.a.createElement("span",{className:P.a.firstSpan},"系统邮箱:"),y.a.createElement("span",{className:P.a.emailBox},y.a.createElement("span",{className:P.a.secondSpan},this.state.email)," ",y.a.createElement(s.a,{type:"edit",onClick:function(){return e.showModal(3)},style:{marginLeft:40}}))),y.a.createElement("p",{style:{display:1==localStorage.getItem("role_id")?"none":"block"}},y.a.createElement("span",{className:P.a.firstSpan},"邮箱:"),y.a.createElement("span",{className:P.a.emailBox},y.a.createElement("span",{className:P.a.secondSpan},this.state.email)," ",y.a.createElement(s.a,{type:"edit",onClick:function(){return e.showModal(1)},style:{marginLeft:40}}))),y.a.createElement("p",null,y.a.createElement("span",{className:P.a.firstSpan},"密码 :"),y.a.createElement("span",{className:P.a.emailBox},y.a.createElement("span",{className:P.a.secondSpan},"******")," ",y.a.createElement(s.a,{type:"edit",onClick:function(){return e.showModal(2)},style:{marginLeft:40}})))),this.state.visible?y.a.createElement(x,{wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,ifCreat:!1,onCreate:function(){return e.handleCreate()},formValues:this.state.formValues}):null,this.state.visibleEmail?y.a.createElement(q,{wrappedComponentRef:this.saveFormRef,visible:this.state.visibleEmail,onCancel:this.handleCancel,ifCreat:!1,onCreate:function(){return e.handleCreate()},formValues:this.state.formValues}):null,this.state.visiblePassword?y.a.createElement(T,{wrappedComponentRef:this.saveFormRef,visible:this.state.visiblePassword,onCancel:this.handleCancel,ifCreat:!1,onCreate:function(){return e.handleCreate()},formValues:this.state.formValues}):null)))}}]),t}(g.PureComponent);a.default=F}.call(this,t("yLpj"))},gtCd:function(e,a,t){e.exports={personalBox:"antd-pro-pages-user-personal-personalBox",firstSpan:"antd-pro-pages-user-personal-firstSpan",secondSpan:"antd-pro-pages-user-personal-secondSpan",emailBox:"antd-pro-pages-user-personal-emailBox"}}}]);