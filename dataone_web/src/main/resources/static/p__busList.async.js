(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"56Lv":function(e,t,a){"use strict";a.r(t),function(e){a("DjyN");var n=a("NUBc"),s=(a("Telt"),a("Tckk")),l=(a("IzEo"),a("bx4M")),r=(a("Mwp2"),a("VXEj")),o=(a("Pwec"),a("CtXQ")),c=(a("aHsQ"),a("sGsY")),i=(a("MXD1"),a("CFYs")),d=(a("+L6B"),a("2/Rp")),u=(a("miYZ"),a("tsqr")),p=a("2Taf"),m=a.n(p),h=a("vZ4D"),g=a.n(h),f=a("l4Ni"),y=a.n(f),S=a("ujKo"),b=a.n(S),E=a("rlhR"),_=a.n(E),C=a("MhPg"),v=a.n(C),k=(a("OaEy"),a("2fM7")),w=(a("5NDa"),a("5rEg")),z=a("q1tI"),j=a.n(z),I=a("usdK"),T=a.n(I),x=a("vDqi"),N=a.n(x),D=a("jHKv"),L=(a("kQFk"),a("w/s/")),M=a.n(L),P=a("yXo+"),B=a.n(P),R=a("/GGx"),A=a.n(R),W=a("gI1x"),q=a.n(W),H=w.a.Search,K=k.a.Option,U=function(t){function a(){var t;return m()(this,a),(t=y()(this,b()(a).apply(this,arguments))).state={dataSourceCard:[],pathurl:"/watch",num0:0,num1:0,num2:0,num3:0,num4:0,num5:0,total:0,current:1,size:1==localStorage.getItem("role_id")?12:11,sizeRecord:1==localStorage.getItem("role_id")?12:11,flag:6,value:0,selectUser:[],selectDept:[],ifadmin:!1,isclick:!0},t.loadDept=function(){var a=e.constants.httpType+e.constants.website+"/sys_user/alluser";t.setState({ifadmin:!1}),1==localStorage.getItem("role_id")&&(t.setState({ifadmin:!0}),a=e.constants.httpType+e.constants.website+"/sys_dept/dept_all/"),N()({method:"post",url:a,headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user");var a=e.data.data;1==localStorage.getItem("role_id")?(a.unshift({dept_id:0,dept_name:"全部",count_user:null}),t.setState({selectDept:a})):(a.unshift({user_id:0,login_name:"全部",count_user:null}),t.setState({selectUser:a}))}).catch(function(e){})},t.loadList=function(a,n,s){t.setState({current:n,size:s,flag:6}),t.setState({deptId:a});var l={current:n,size:s,deptId:a};N()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/selJobrelaByDeptIdPage/",data:D.a.Amap(l),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user");var a=[""];if(1!=localStorage.getItem("role_id")&&3!=localStorage.getItem("role_id")||(a=[]),1==e.data.status)for(var n=0;n<e.data.data.length;n++)e.data.data[n].key=e.data.data[n].id,a.push(e.data.data[n]);t.setState({dataSourceCard:a,total:e.data.totalCount}),t.loadNum()}).catch(function(e){})},t.loadNum=function(){var a={deptId:void 0==t.state.deptId?0:t.state.deptId};N()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/jobrela_count/",data:D.a.Amap(a),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),t.setState({num4:e.data[0],num3:e.data[2],num2:e.data[1],num1:e.data[3],num0:e.data[4],num5:e.data[5]})}).catch(function(e){})},t.onchange1=function(a,n,s,l){t.setState({flag:n,current:s});var r={job_status:n,current:s,size:l,deptId:void 0==t.state.deptId?0:t.state.deptId};N()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/some_jobrela/",data:D.a.Amap(r),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user");var a=[""];if(1!=localStorage.getItem("role_id")&&3!=localStorage.getItem("role_id")||(a=[]),1==e.data.status)for(var n=0;n<e.data.data.length;n++)e.data.data[n].key=n,a.push(e.data.data[n]);t.setState({dataSourceCard:a,total:e.data.totalCount})}).catch(function(e){})},t.search=function(a){t.setState({value:a,flag:7});var n={job_name:a,current:1,size:t.state.size};N()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/query_jobrela/",data:D.a.Amap(n),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user");var a=[""];if(1!=localStorage.getItem("role_id")&&3!=localStorage.getItem("role_id")||(a=[]),1==e.data.status)for(var n=0;n<e.data.data.length;n++)e.data.data[n].key=e.data.data[n].id,a.push(e.data.data[n]);t.setState({dataSourceCard:a,total:e.data.totalCount})}).catch(function(e){})},t.search1=function(a,n,s){var l={job_name:a,current:t.state.current,size:t.state.size};N()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/query_jobrela/",data:D.a.Amap(l),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user");var a=[""];if(1!=localStorage.getItem("role_id")&&3!=localStorage.getItem("role_id")||(a=[]),1==e.data.status)for(var n=0;n<e.data.data.length;n++)e.data.data[n].key=e.data.data[n].id,a.push(e.data.data[n]);t.setState({dataSourceCard:a,total:e.data.totalCount})}).catch(function(e){})},t.reset=function(){t.setState({flag:6}),t.loadList(0,1,t.state.size)},t.showModal=function(e){1!=localStorage.getItem("role_id")?"00"==e?T.a.push("/busCreat"):T.a.push("/busCreat?n="+e):u.a.error("权限不足")},t.btnStatue=function(e){return 5==e.job_status?[j.a.createElement(d.a,{onClick:function(){return t.showModal(e.id)},type:"primary",style:{background:"#e6f7ff"}},"去完善")]:0==e.job_status?[j.a.createElement("span",null,j.a.createElement(d.a,{type:"primary",onClick:function(a){return t.activeThing(a,e.id)},style:{background:"#e6f7ff",padding:"2px 4px"}},"立即激活"),j.a.createElement(d.a,{onClick:function(){return t.showModal(e.id)},type:"primary",style:{background:"#e6f7ff",padding:"2px 4px"}},"去完善"))]:1==e.job_status||11==e.job_status?[j.a.createElement("span",null,j.a.createElement("span",{style:{color:"#02c58d",letterSpacing:"5px",fontSize:14}},"运行中"),j.a.createElement("br",null),j.a.createElement("span",{style:{fontSize:12,color:"#333",letterSpacing:1,marginTop:"10px",display:"inline-block"}},1==e.sync_range?"全量":2==e.sync_range?"增量同步":3==e.sync_range?"全量+增量":"存量同步")),j.a.createElement(i.a,{type:"circle",className:M.a.jinduColor1,percent:30,width:60,strokeColor:"#02c58d"})]:2==e.job_status||21==e.job_status?[j.a.createElement("span",null,j.a.createElement("span",{style:{color:"#4664b4",letterSpacing:"5px",fontSize:14}},"暂停中"),j.a.createElement("br",null),j.a.createElement("span",{style:{fontSize:12,color:"#333",letterSpacing:1,marginTop:"10px",display:"inline-block"}},1==e.sync_range?"全量":2==e.sync_range?"增量同步":3==e.sync_range?"全量+增量":"存量同步")),j.a.createElement(i.a,{className:M.a.jinduColor2,type:"circle",percent:30,width:60,style:{color:"red"},strokeColor:"#4664b4"})]:3==e.job_status||31==e.job_status?[j.a.createElement("span",null,j.a.createElement("span",{style:{color:"#db615d",letterSpacing:"5px",fontSize:14}},"已终止"),j.a.createElement("br",null),j.a.createElement("span",{style:{fontSize:12,color:"#333",letterSpacing:1,marginTop:"10px",display:"inline-block"}},1==e.sync_range?"全量":2==e.sync_range?"增量同步":3==e.sync_range?"全量+增量":"存量同步")),j.a.createElement(i.a,{className:M.a.jinduColor3,type:"circle",percent:30,width:60,style:{color:"red"},strokeColor:"#db615d"})]:4==e.job_status?[j.a.createElement("span",null,j.a.createElement("span",{style:{color:"#eca904",letterSpacing:"5px",fontSize:14}},"异常中"),j.a.createElement("br",null),j.a.createElement("span",{style:{fontSize:12,color:"#333",letterSpacing:1,marginTop:"10px",display:"inline-block"}},1==e.sync_range?"全量":2==e.sync_range?"增量同步":3==e.sync_range?"全量+增量":"存量同步")),j.a.createElement(i.a,{className:M.a.jinduColor4,type:"circle",percent:30,width:60,style:{color:"red"},strokeColor:"#eca904"})]:void 0},t.activeThing=function(a,n){a.stopPropagation();var s=_()(t);if(t.state.isclick){if(t.state.isclick){t.setState({isclick:!1});var l={id:n},r=e.constants.httpType+e.constants.website+"/sys_jobrela/start/";N()({method:"post",url:r,data:D.a.Amap(l),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),1==e.data.status?(u.a.success(e.data.message),t.loadList(t.state.deptId,t.state.current,t.state.size)):u.a.error(e.data.message)}).catch(function(e){})}setTimeout(function(){s.setState({isclick:!0})},5e3)}},t.changePage=function(e,t){0!=e&&5!=e&&(window.location.href="/watch?n="+t)},t.onChange=function(e,a){t.setState({current:e,size:a});var n=t.state.flag;if(6==n)t.loadList(t.state.deptId,e,a);else if(0==n||1==n||2==n||3==n||4==n||5==n)t.onchange1(event,n,e,a);else if(7==n){var s=t.state.value;t.search1(s,e,a)}},t.onShowSizeChange=function(e,a){t.setState({current:e,size:a});var n=t.state.flag;if(6==n)t.loadList(t.state.deptId,e,a);else if(0==n||1==n||2==n||3==n||4==n||5==n)t.onchange1(event,n,e,a);else if(7==n){var s=t.state.value;t.search1(s,e,a)}},t}return v()(a,t),g()(a,[{key:"componentDidMount",value:function(){this.loadList(0,1,this.state.size),this.loadDept()}},{key:"render",value:function(){var e=this;return j.a.createElement("div",{style:{width:"80%",margin:"0 auto"}},j.a.createElement("div",{className:M.a.searchHeader},j.a.createElement(k.a,{defaultValue:0,onChange:function(t){return e.loadList(t,1,e.state.size)},style:{width:120,marginRight:10,display:1==localStorage.getItem("role_id")?"block":"none"}},this.state.selectDept.map(function(e){return j.a.createElement(K,{value:e.dept_id},e.dept_name)})),j.a.createElement(k.a,{defaultValue:0,onChange:function(t){return e.loadList(t,1,e.state.size)},style:{width:120,display:2==localStorage.getItem("role_id")?"block":"none"}},this.state.selectUser.map(function(e){return j.a.createElement(K,{value:e.user_id},e.login_name)})),j.a.createElement("div",{className:M.a.SearchTitle},j.a.createElement(H,{placeholder:"请输入任务名称关键字",onSearch:this.search,className:M.a.searchSelect}),j.a.createElement(d.a,{className:M.a.but,onClick:this.reset},"重置"))),j.a.createElement("div",{className:M.a.searchBox},j.a.createElement("span",{className:M.a.spanTitle},"任务列表总览"),j.a.createElement("span",{onClick:function(t){return e.onchange1(t,0,1,e.state.size)},className:M.a.searchCard},j.a.createElement(c.a,{title:j.a.createElement("span",null,j.a.createElement(o.a,{type:"select"}),"   ",j.a.createElement("span",{style:{fontWeight:"bold"}},"待激活")),value:this.state.num0,valueStyle:{color:"#fff",fontSize:16},suffix:"个"})),j.a.createElement("span",{onClick:function(t){return e.onchange1(t,5,1,e.state.size)},className:M.a.searchCard},j.a.createElement(c.a,{title:j.a.createElement("span",null,j.a.createElement(o.a,{type:"edit"}),"   ",j.a.createElement("span",{style:{fontWeight:"bold"}},"待完善")),value:this.state.num1,valueStyle:{color:"#fff",fontSize:16},suffix:"个"})),j.a.createElement("span",{onClick:function(t){return e.onchange1(t,3,1,e.state.size)},className:M.a.searchCard},j.a.createElement(c.a,{title:j.a.createElement("span",null,j.a.createElement(o.a,{type:"edit"}),"   ",j.a.createElement("span",{style:{fontWeight:"bold"}},"已终止")),value:this.state.num5,valueStyle:{color:"#fff",fontSize:16},suffix:"个"})),j.a.createElement("span",{onClick:function(t){return e.onchange1(t,4,1,e.state.size)},className:M.a.searchCard},j.a.createElement(c.a,{title:j.a.createElement("span",null,j.a.createElement(o.a,{type:"warning"}),"   ",j.a.createElement("span",{style:{fontWeight:"bold"}},"异常中")),value:this.state.num2,valueStyle:{color:"#fff",fontSize:16},suffix:"个"})),j.a.createElement("span",{onClick:function(t){return e.onchange1(t,2,1,e.state.size)},className:M.a.searchCard},j.a.createElement(c.a,{title:j.a.createElement("span",null,j.a.createElement(o.a,{type:"pause-circle"}),"   ",j.a.createElement("span",{style:{fontWeight:"bold"}},"暂停中")),value:this.state.num3,valueStyle:{color:"#fff",fontSize:16},suffix:"个"})),j.a.createElement("span",{onClick:function(t){return e.onchange1(t,1,1,e.state.size)},className:M.a.searchCard},j.a.createElement(c.a,{title:j.a.createElement("span",null,j.a.createElement(o.a,{type:"play-circle"}),"   ",j.a.createElement("span",{style:{fontWeight:"bold"}},"运行中")),value:this.state.num4,valueStyle:{color:"#fff",fontSize:16},suffix:"个"}))),j.a.createElement(r.a,{rowKey:"id",className:M.a.departmentCard,grid:{gutter:24,xl:5,lg:4,md:3,sm:2,xs:1},dataSource:this.state.dataSourceCard,renderItem:function(t){return t?j.a.createElement(r.a.Item,null,j.a.createElement(l.a,{size:"small",hoverable:!0,className:M.a.listCard,title:j.a.createElement("span",{title:t.job_name},t.job_name),actions:e.btnStatue(t),onClick:function(){return e.changePage(t.job_status,t.id)},key:t.id},j.a.createElement("p",{style:{margin:0,fontSize:12,marginBottom:4},title:t.source_name},j.a.createElement(s.a,{src:1==t.source_type?B.a:q.a}),"   ",t.source_name.substring(0,16)),j.a.createElement("p",{style:{margin:0,fontSize:12},title:t.dest_name},j.a.createElement(s.a,{src:1==t.dest_type?B.a:2==t.dest_type?q.a:A.a}),"   ",t.dest_name.substring(0,16)))):j.a.createElement(r.a.Item,null,j.a.createElement(d.a,{type:"dashed",onClick:function(){return e.showModal("00")},style:{height:"220px",width:"100%"}},j.a.createElement(o.a,{type:"plus"})," 新建任务"))}}),j.a.createElement(n.a,{ref:"page",className:M.a.pagesCard,pageSizeOptions:[""+this.state.sizeRecord,""+2*this.state.sizeRecord,""+5*this.state.sizeRecord],showSizeChanger:!0,pagination:!0,onChange:this.onChange,onShowSizeChange:this.onShowSizeChange,current:this.state.current,defaultPageSize:this.state.size,total:this.state.total}))}}]),a}(z.PureComponent);t.default=U}.call(this,a("yLpj"))},"w/s/":function(e,t,a){e.exports={searchHeader:"antd-pro-pages-bus-list-searchHeader",SearchTitle:"antd-pro-pages-bus-list-SearchTitle",searchSelect:"antd-pro-pages-bus-list-searchSelect",but:"antd-pro-pages-bus-list-but",searchBox:"antd-pro-pages-bus-list-searchBox",spanTitle:"antd-pro-pages-bus-list-spanTitle",searchCard:"antd-pro-pages-bus-list-searchCard",departmentCard:"antd-pro-pages-bus-list-departmentCard",listCard:"antd-pro-pages-bus-list-listCard",jinduColor1:"antd-pro-pages-bus-list-jinduColor1",jinduColor2:"antd-pro-pages-bus-list-jinduColor2",jinduColor3:"antd-pro-pages-bus-list-jinduColor3",jinduColor4:"antd-pro-pages-bus-list-jinduColor4",tableCard:"antd-pro-pages-bus-list-tableCard",pagesCard:"antd-pro-pages-bus-list-pagesCard"}}}]);