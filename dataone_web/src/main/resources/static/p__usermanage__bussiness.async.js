(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"4MtT":function(e,t,a){"use strict";a.r(t),function(e){a("g9YV");var n=a("wCAj"),s=(a("Telt"),a("Tckk")),o=(a("Mwp2"),a("VXEj")),r=(a("IzEo"),a("bx4M")),l=a("p0pE"),c=a.n(l),i=(a("miYZ"),a("tsqr")),d=(a("Pwec"),a("CtXQ")),u=(a("+L6B"),a("2/Rp")),m=a("2Taf"),h=a.n(m),f=a("vZ4D"),g=a.n(f),y=a("l4Ni"),b=a.n(y),p=a("ujKo"),w=a.n(p),S=a("MhPg"),_=a.n(S),I=(a("5NDa"),a("5rEg")),k=(a("OaEy"),a("2fM7")),v=(a("B9cy"),a("Ol7k")),E=(a("2qtc"),a("kLXV")),C=a("q1tI"),R=a.n(C),L=a("vDqi"),K=a.n(L),T=a("jHKv"),j=(a("kQFk"),a("UmVj")),N=a.n(j),x=(E.a.confirm,v.a.Content),J=(v.a.Sider,k.a.Option,I.a.Search,function(t){function a(){var t;return h()(this,a),(t=b()(this,w()(a).apply(this,arguments))).state={selectItem:"2",selectgroupItem:"001",stepValue:"1",visible:!1,visibleCreat:!1,visibleUpdate:!1,numberList:[],optionList:[],dataSource:[],numberSatus:1,ifNumber:!1,roleId:localStorage.getItem("role_id"),usermanageIf:!0,userId:0},t.color16=function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),a=Math.floor(256*Math.random());return"#"+e.toString(16)+t.toString(16)+a.toString(16)},t.changeTeam=function(){if(1!=localStorage.getItem("role_id")&&3!=localStorage.getItem("role_id")){var a=e.constants.httpType+e.constants.website+"/sys_user/alluser/";K()({method:"post",url:a,headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user");for(var a=e.data.data,n=0;n<a.length;n++)a[n].color=t.color16();t.searchJob(a[0]),t.setState({dataList:a})}).catch(function(e){})}else E.a.warning({title:"警告",content:"您没有权限查看任务管理模块",onOk:function(){window.location.href="/busList"},okText:"回到首页"})},t.searchJob=function(a,n){var s={userId:n||a.user_id};K()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/findUserJob/",data:T.a.Amap(s),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){if("401"==e.data.status&&(window.location.href="/user"),1==e.data.status){for(var s=e.data.data,o=[],r=0;r<s.length;r++){var l={key:s[r].job_id,job_id:s[r].job_id,job_name:s[r].job_name,user_name:s[r].user_name,create_time:s[r].create_time,create_user:s[r].create_user};o.push(l)}void 0!=n||"管理员"!=a.role_name?t.setState({dataeditSource:o}):t.setState({dataSource:o})}}).catch(function(e){})},t.searchnoJob=function(a,n){var s={userId:n||a};K()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/findUserJobNo/",data:T.a.Amap(s),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){if("401"==e.data.status&&(window.location.href="/user"),1==e.data.status){for(var a=e.data.data,n=[],s=0;s<a.length;s++){var o={key:a[s].job_id,job_id:a[s].job_id,job_name:a[s].job_name,user_name:a[s].user_name,create_time:a[s].create_time,create_user:a[s].create_user};n.push(o)}t.setState({datanoSource:n})}}).catch(function(e){})},t.changeItem=function(e,a){"管理员"==a.role_name?(t.searchJob(a),t.setState({usermanageIf:!0,userId:a.user_id,selectedRowKeys:null,selectedRowKeys2:null})):(t.searchJob(a),t.searchnoJob(a.user_id),t.setState({usermanageIf:!1,userId:a.user_id,selectedRowKeys:null,selectedRowKeys2:null})),0!=document.getElementsByClassName("addStyle").length&&(document.getElementsByClassName("addStyle")[0].classList.add("aList"),document.getElementsByClassName("addStyle")[0].classList.remove("addStyle"));var n=e.target;if(-1!=n.className.indexOf("aList"))return n.classList.remove("aList"),n.classList.add("addStyle"),n;for(;-1==n.className.indexOf("aList");)n=n.parentNode;n.classList.remove("aList"),n.classList.add("addStyle")},t.getColumnSearchProps=function(e){return{filterDropdown:function(e){var a=e.setSelectedKeys,n=e.selectedKeys,s=e.confirm,o=e.clearFilters;return R.a.createElement("div",{style:{padding:12},className:"ant-table-filter-dropdown"},R.a.createElement(I.a,{ref:function(e){t.searchInput=e},placeholder:"请输入搜索关键字",value:n[0],onChange:function(e){return a(e.target.value?[e.target.value]:[])},onPressEnter:function(){return t.handleSearch(n,s)},style:{width:188,marginBottom:8,display:"block"}}),R.a.createElement(u.a,{type:"primary",onClick:function(){return t.handleSearch(n,s)},icon:"search",size:"small",style:{width:90,marginRight:8}},"搜索"),R.a.createElement(u.a,{onClick:function(){return t.handleReset(o)},size:"small",style:{width:90}},"重置"))},filterIcon:function(e){return R.a.createElement(d.a,{type:"search",style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return a[e].toString().toLowerCase().includes(t.toLowerCase())},onFilterDropdownVisibleChange:function(e){e&&setTimeout(function(){return t.searchInput.select()})}}},t.handleSearch=function(e,a){a(),t.setState({searchText:e[0]})},t.handleReset=function(e){e(),t.setState({searchText:""})},t.deleteBus=function(){if(null!=t.state.selectedRowKeys&&void 0!=t.state.selectedRowKeys&&0!=t.state.selectedRowKeys.length){var a={jobrela_id:t.state.selectedRowKeys,userId:t.state.userId};K()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/deleteUserJobRela/",data:T.a.Amap(a),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),1==e.data.status&&(i.a.success("删除成功"),t.searchJob(null,t.state.userId),t.searchnoJob(null,t.state.userId),t.setState({selectedRowKeys:null,selectedRowKeys2:null}))}).catch(function(e){})}else i.a.error("请选择要删除的任务！")},t.addBus=function(a){if(void 0!=t.state.selectedRowKeys2&&null!=t.state.selectedRowKeys2&&0!=t.state.selectedRowKeys2.length){var n={jobrela_id:t.state.selectedRowKeys2,userId:t.state.userId};K()({method:"post",url:e.constants.httpType+e.constants.website+"/sys_jobrela/addUserJob/",data:T.a.Amap(n),headers:{authToken:localStorage.getItem("authToken")}}).then(function(e){"401"==e.data.status&&(window.location.href="/user"),1==e.data.status&&(i.a.success("添加成功"),t.setState({selectedRowKeys2:null}),t.searchJob(null,t.state.userId),t.searchnoJob(null,t.state.userId))}).catch(function(e){})}else i.a.error("请选择要绑定的参与的任务")},t.columnsusermanage=[c()({title:"名称",dataIndex:"job_name",key:"job_name",width:180},t.getColumnSearchProps("job_name")),c()({title:"参与人",dataIndex:"user_name",key:"user_name",width:260},t.getColumnSearchProps("user_name"),{render:function(e,t){return R.a.createElement("span",{title:e},e.substring(0,16)," ",e.length>16?"...":"")}}),{title:"修改时间",dataIndex:"create_time",key:"create_time",width:180},{title:"最后修改人",dataIndex:"create_user",key:"create_user",width:110}],t.onSelectChange=function(e,a){t.setState({selectedRowKeys:e})},t.onSelectChange2=function(e,a){t.setState({selectedRowKeys2:e})},t}return _()(a,t),g()(a,[{key:"componentDidMount",value:function(){this.changeTeam()}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRowKeys,l=(t.selectedRowKeys2,{selectedRowKeys:a,onChange:this.onSelectChange,getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}}),c={selectedRowKeys:this.state.selectedRowKeys2,onChange:this.onSelectChange2,getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return R.a.createElement(v.a,{className:N.a.layoutBox},R.a.createElement(x,{style:{background:"#fff",paddingLeft:24,minHeight:280}},R.a.createElement(r.a,{style:{marginTop:20,border:"none",borderRight:"1px solid #ddd",width:360,float:"left"}},R.a.createElement("h3",{style:{fontWeight:"bolder",marginBottom:30}},"小组成员"),R.a.createElement(o.a,{itemLayout:"horizontal",dataSource:this.state.dataList,className:N.a.ListItem,renderItem:function(t){return R.a.createElement("span",{onClick:function(a){return e.changeItem(a,t)},className:"管理员"==t.role_name?"addStyle":"aList",style:{cursor:"pointer"}},R.a.createElement(o.a.Item,{actions:[R.a.createElement("span",null,t.role_name)]},R.a.createElement(o.a.Item.Meta,{avatar:R.a.createElement(s.a,{style:{color:"#fff",backgroundColor:t.color,verticalAlign:"middle",fontSize:18,marginLeft:10},size:"large"},t.login_name.substr(0,1)),title:R.a.createElement("a",null,t.login_name),description:t.email})))}})),R.a.createElement(r.a,{style:{float:"left",marginLeft:80,width:"calc( 100% - 500px)",border:"none"},className:N.a.busCard},R.a.createElement("div",{style:{display:this.state.usermanageIf?"block":"none"}},R.a.createElement(r.a,{title:"任务列表",style:{border:"none"},className:N.a.tableCard},R.a.createElement(n.a,{className:N.a.tableBox,dataSource:this.state.dataSource,columns:this.columnsusermanage,pagination:!1,scroll:{y:360}}))),R.a.createElement(r.a,{title:"已参与任务",extra:R.a.createElement(u.a,{type:"primary",onClick:this.deleteBus},"解除任务"),style:{border:"none",display:this.state.usermanageIf?"none":"block"},className:N.a.tableCard},R.a.createElement(n.a,{className:N.a.tableBox,rowSelection:l,dataSource:this.state.dataeditSource,columns:this.columnsusermanage,pagination:!1,scroll:{y:200}})),R.a.createElement(r.a,{title:"未参与任务",extra:R.a.createElement(u.a,{type:"primary",onClick:this.addBus},"参与任务"),style:{border:"none",display:this.state.usermanageIf?"none":"block"},className:N.a.tableCard},R.a.createElement(n.a,{className:N.a.tableBox,rowSelection:c,dataSource:this.state.datanoSource,columns:this.columnsusermanage,pagination:!1,scroll:{y:200}})))))}}]),a}(C.PureComponent));t.default=J}.call(this,a("yLpj"))}}]);